
![2025-02-14](https://github.com/user-attachments/assets/ae9da35b-1e0d-4f71-88b7-e472d8eac3dd)

# (Анти)паттерн Singleton в C (Си)

Youtube-запись лекции: https://youtu.be/l__Somx2Zes ```2025-02-14```

## Хотим…

…иметь сущность, которая создаётся один раз — и потом делает ту работу, для которой предназначена, в каком бы месте программы нам бы эта работа ни потребовалась.

- Нужное всю дорогу: доступ к файлу или базе данных (`FILE *****` как бы намекает)
- Чему отдаются команды: курсор, экран
- Про что нужно знать на каждом шагу: состояние системы (но тут грустно)
- Ломающее логику: информация об ошибке

## Почему «анти»?

- Решает сразу две задачи: создание один раз + доступ отовсюду
- Бывает, что реализация не поддаётся модульному тестированию
- Требует усилий при реализации многопоточности
- Соблазнительно создать всемогущую «божественную сущность»
    
    ![og_og_1615545282236637952.jpg](attachment:ec362e3b-a366-46a7-b68d-722744d90ef3:og_og_1615545282236637952.jpg)
    

**Но мы всё равно им думаем**
И делаем


Лучше бить
на паттерны **почётче**


## Социальные доказательства

> Взято из книги «[Язык C. Мастерство программирования](https://dmkpress.com/catalog/computer/programming/c/978-6-01810-340-7/)», Кристофер Прешерн, 2023
> 

`<strings.h>` → `strtok()` • `<math.h>` → `rand()` • `<stdio.h>` → `fopen()` + курсор

## Почему не само собой?

- Ну хотя бы видимость? А потому что видимость переменных — в пределах блока (и единицы компиляции)

## Что имеем из инструментов?

- `static` «взламывает» область видимости
- Указатель передаёт данные в любой блок
- Динамическая память существует без привязки к блоку

## Теперь код


**Сделаем библиотеку для развлечений с символьным экраном**
И снабдим её курсором

Код тут: https://github.com/olgapavlova/symscreen
